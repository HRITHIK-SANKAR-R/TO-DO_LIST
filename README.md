# TK24  TO_DO BACK_END

### Intro to the Project

Welcome to the To-Do List API documentation. This API allows you to manage a simple to-do list with basic CRUD (Create, Read, Update, Delete) operations. It is built using Node.js for the server-side logic and PostgreSQL as the database.I used insomnia to check on my CRUD operations.I haved entered the values in JSON in insomnia. 


## API Endpoints

### Create a Task - USING POST METHOD

```
http://localhost:6969/

```

```JSON
{
	"Task":"5 pushups"
}

```

```python
> INSERTING VALUES IN TABLE

app.post('/', async (req, res) => {
  const { Task } = req.body;

  const sql = 'INSERT INTO TO_DO ("Task") VALUES ($1) RETURNING "Id"';
  const params = [Task];

  try {
      const result = await pool.query(sql, params);
      const id=result.rows[0].Id;
      console.log(id);
      res.status(200).json({ Id: result.rows[0].id,Task });
  } catch (error) {
      console.error(error.message);
      if (error.code === '23505') {
          return res.status(409).json({ error: 'Task already exists' });
      }
      res.status(500).json({ error: 'Server error' });
  }
});
```
---

### Get All Tasks -USING GET METHOD

```
http://localhost:6969/

```

```python
>RETRIEVING VALUES FROM THE TABLE
 app.get('/', (req, res) => {
    pool.query('SELECT * FROM TO_DO ORDER BY "Id" ASC;', (err, result) => {
      if (err) {
        console.error(err.message);
        return res.status(500).json({ error: 'Server error' });
      }
  
      const tasks = result.rows.reduce((acc, task) => {
        task.status ? acc.Completed.push(task) : acc.Incomplete.push(task);
        return acc;
      }, { Completed: [], Incomplete: [] });
  
      res.json(tasks);
    });
  });
```
---

### Update Task Status - USING PUT METHOD

```
http://localhost:6969/
```
```JSON
{
	"Id":10254,
	"Status": true
}
```

```python
> UPDATING THE VALUES OF THE STATUS
  app.put('/', async (req, res) => {
    const { Id, Status } = req.body;
    const params = [Status,Id]; 
  
    const sql = 'UPDATE TO_DO SET "Status" = $1 WHERE "Id" = $2 RETURNING "Id"';
  
    try {
      const result = await pool.query(sql, params);
      console.log(Id);
      const id=result.rows[0].Id;
      res.status(200).json({Id: result.rows[0].id,Status});
    } catch (error) {
      console.error(error.message);
      res.status(500).json({ error: 'Server error' });
    }
  });
```
---

### Delete a Task - USING DELETE METHOD

```
http://localhost:6969/10121
```

```python
> DELETING VALUES FROM THE TABLE
   app.delete('/:Id', async(req, res) => { //specify the id
   const { Id } = req.params;
   const params=[Id];
   const sql='DELETE FROM TO_DO WHERE "Id" = $1 RETURNING "Id"';
    try {
      const result = await pool.query(sql, params);
      if (result.rows.length === 0) {
        return res.status(404).json({ error: 'Task not found' });
      }
      const id=result.rows[0].Id;
      return res.json({ Message: 'Task deleted successfully', DeletedTaskId: Id });
    } catch (error) {
      console.error(error.message);
      return res.status(500).json({ error: 'Server error' });
    }
      
    });
```
---

### Delete All Tasks - USING DELETE METHOD

```
http://localhost:6969/
```

```python
// DELETING ALL ROWS FROM THE TABLE
    app.delete('/', (req, res) => {
      pool.query('DELETE FROM TO_DO', (err, result) => {
        if (err) {
          console.error(err.message);
          return res.status(500).json({ error: 'Server error' });
        }
    
      return res.json({ Message: 'All tasks deleted successfully' });
      });
    });
```
---

## Database Example

| id    | task          | created      | status |
|-------|---------------|--------------|--------|
|  10207 | ID CREATION | 2024-01-09 22:52:11.917111 | f
 10208   | 5 pushups   | 2024-01-10 18:40:57.808211 | f
 10209   | 5 pushups   | 2024-01-10 18:48:25.167205 | f  |


---

## Database Schema
```sql
CREATE TABLE IF NOT EXISTS TO_DO (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY ( INCREMENT 1 START 10120 MINVALUE 10120 MAXVALUE 2147483647 CACHE 1),
    "Task" VARCHAR(255) NOT NULL,
    "Created" timestamp without time zone NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "Status" boolean NOT NULL DEFAULT false
  )`
```

## ENVIRONMENT VARIABLES - CONNECTING DATABASE

I have created environment variables for connecting database in .env file.

```
USER_NAME = "postgres"
HOST_NAME ='localhost'
DB_NAME ="TODO"
DB_PASSWORD = "PASSWORD"
DB_DIALECT="postgres"
PORT_NUMBER = 5432

```
